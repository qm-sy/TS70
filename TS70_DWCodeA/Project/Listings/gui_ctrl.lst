C51 COMPILER V9.60.7.0   GUI_CTRL                                                          10/15/2025 21:46:46 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE GUI_CTRL
OBJECT MODULE PLACED IN ..\Output\gui_ctrl.obj
COMPILER INVOKED BY: D:\APP\KEIL\MDK\C51\BIN\C51.EXE ..\Emembed\Src\gui_ctrl.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\
                    -BSP\Inc;..\Core\Inc;..\Driver;..\SYSTEM;..\Emembed\Inc) DEBUG OBJECTEXTEND PRINT(.\Listings\gui_ctrl.lst) TABS(2) OBJECT
                    -(..\Output\gui_ctrl.obj)

line level    source

   1          #include "gui_ctrl.h"
   2          
   3          SP350 sp350;
   4          HANSEN hansen;
   5          DAYIN_T dayin_t;
   6          
   7          void sp350_parms_init( void )
   8          {
   9   1          sp350.alarm_tempF = 50;         
  10   1          sp350.alarm_tempM = 55;         
  11   1          sp350.alarm_tempR = 60;         
  12   1          sp350.F_switch    = 1;          
  13   1          sp350.M_switch    = 1;          
  14   1          sp350.R_switch    = 1;          
  15   1          sp350.LED_switch  = 1;          
  16   1          sp350.fan_switch  = 1;         
  17   1          sp350.fan_level   = 1;
  18   1      
  19   1          sys_write_vp(0x2010,(uint8_t*)&sp350.alarm_tempF,1);
  20   1          sys_write_vp(0x2011,(uint8_t*)&sp350.alarm_tempM,1);
  21   1          sys_write_vp(0x2012,(uint8_t*)&sp350.alarm_tempR,1);
  22   1      
  23   1          sys_write_vp(0x2013,(uint8_t*)&sp350.F_switch,1);
  24   1          sys_write_vp(0x2014,(uint8_t*)&sp350.M_switch,1);
  25   1          sys_write_vp(0x2015,(uint8_t*)&sp350.R_switch,1);
  26   1      
  27   1          sys_write_vp(0x2016,(uint8_t*)&sp350.LED_switch,1);
  28   1      
  29   1          sys_write_vp(0x2017,(uint8_t*)&sp350.fan_switch,1);
  30   1          sys_write_vp(0x201a,(uint8_t*)&sp350.fan_level,1);
  31   1      }
  32          
  33          void diwen_parms_init( void )
  34          {
  35   1          hansen.ctrl_flag = 0;
  36   1          hansen.connect_flag = 0;
  37   1          hansen.addr_0x00 = 0x00;
  38   1          hansen.addr_0x02 = 0x00;
  39   1          hansen.addr_0x06 = 0x0149;
  40   1          hansen.addr_0x10 = 0x1f;
  41   1          hansen.addr_0x20 = 0x00;
  42   1          hansen.addr_0x21 = 0x00;
  43   1          hansen.addr_0x22 = 0x00;
  44   1          hansen.addr_0x23 = 0x00;
  45   1          hansen.addr_0x2d = 0x00;
  46   1          hansen.addr_0x30 = 0x00;
  47   1          hansen.addr_0x0c = 0x01;
  48   1      
  49   1          hansen.paoji_flag = hansen.paoji_send = 0;
  50   1          hansen.paoji_h = hansen.paoji_min = hansen.paoji_s = 0;
  51   1      }
  52          
  53          void gui_vol_ctrl( uint16_t addr, uint8_t val_H, uint8_t val_L)
C51 COMPILER V9.60.7.0   GUI_CTRL                                                          10/15/2025 21:46:46 PAGE 2   

  54          {
  55   1          uint8_t val_tab[2] = {0};
  56   1          uint8_t utf_tab[4] = {0XBA,0XDA,0XD4,0XB2};
  57   1          uint8_t i = 0;
  58   1          static uint8_t addr_20a0 = 0;
  59   1      
  60   1          switch ( addr )
  61   1          {   
  62   2              /*      0x20 马达复位：置1后开始复位，等待被置0        */
  63   2              /*      0x20 跑机操作：置1后开始复位，等待被置0        */
  64   2              /*      0x20 点动操作：置1一直移动，写0后停止移动      */
  65   2              /*      0x20 bit0  x马达复位     */
  66   2              /*      0x20 bit3  左移          */
  67   2              /*      0x20 bit4  右移          */
  68   2              /*      0x20 bit5  进料          */
  69   2              /*      0x20 bit6  退料          */
  70   2              /*      0x20 bit9  开始跑机      */
  71   2              /*      0x20 bit13  停止跑机     */
  72   2              case 0x2020:
  73   2                  hansen.addr_0x20 = (val_H << 8) |  val_L;
  74   2                  
  75   2                  break;
  76   2      
  77   2              case 0x2021:
  78   2                  hansen.addr_0x21 = (val_H << 8) |  val_L;
  79   2                  
  80   2                  break;
  81   2      
  82   2              case 0x2022:
  83   2                  hansen.addr_0x22 = (val_H << 8) |  val_L;
  84   2                  
  85   2                  break;   
  86   2      
  87   2              case 0x2023:
  88   2                  hansen.addr_0x23 = (val_H << 8) |  val_L;
  89   2                  
  90   2                  break;
  91   2      
  92   2              case 0x2030:
  93   2                  hansen.addr_0x30 = (val_H << 8) |  val_L;
  94   2                  
  95   2                  break;
  96   2      
  97   2              case 0x2051:
  98   2                  hansen.addr_0x06 &= ~0x07;
  99   2                  switch (val_L)
 100   2                  {
 101   3                      case 1: hansen.addr_0x06 |= 0x01;       break;
 102   3                      case 2: hansen.addr_0x06 |= 0x02;       break;
 103   3                      case 3: hansen.addr_0x06 |= 0x04;       break;
 104   3                      default:                                break;
 105   3                  }
 106   2                  
 107   2                  break;
 108   2      
 109   2              case 0x2052:
 110   2                  hansen.addr_0x06 &= ~0x38;
 111   2                  switch (val_L)
 112   2                  {
 113   3                      case 1: hansen.addr_0x06 |= 0x08;       break;
 114   3                      case 2: hansen.addr_0x06 |= 0x10;       break;
 115   3                      case 3: hansen.addr_0x06 |= 0x20;       break;
C51 COMPILER V9.60.7.0   GUI_CTRL                                                          10/15/2025 21:46:46 PAGE 3   

 116   3                      default:                                break;
 117   3                  }
 118   2                  
 119   2                  break;
 120   2      
 121   2              case 0x2053:
 122   2                  hansen.addr_0x06 &= ~0xC0;
 123   2                  switch (val_L)
 124   2                  {
 125   3                      case 1: hansen.addr_0x06 |= 0x40;       break;
 126   3                      case 2: hansen.addr_0x06 |= 0x80;       break;
 127   3                      case 3: hansen.addr_0x06 |= 0xc0;       break;
 128   3                      default:                                break;
 129   3                  }
 130   2                  
 131   2                  break;
 132   2      
 133   2              case 0x2054:
 134   2                  hansen.addr_0x06 &= ~0x0700;
 135   2                  switch (val_L)
 136   2                  {
 137   3                      case 1: hansen.addr_0x06 |= 0x0100;     break;
 138   3                      case 2: hansen.addr_0x06 |= 0x0200;     break;
 139   3                      case 3: hansen.addr_0x06 |= 0x0400;     break;
 140   3                      default:                                break;
 141   3                  }
 142   2                  
 143   2                  break;
 144   2      
 145   2              case 0x2055:
 146   2                  hansen.addr_0x06 &= ~0x1800;
 147   2                  switch (val_L)
 148   2                  {
 149   3                      case 0: hansen.addr_0x06 |= 0x0000;     break;
 150   3                      case 1: hansen.addr_0x06 |= 0x0800;     break;
 151   3                      case 2: hansen.addr_0x06 |= 0x1000;     break;
 152   3                      case 3: hansen.addr_0x06 |= 0x1800;     break;
 153   3                      default:                                break;
 154   3                  }
 155   2                  
 156   2                  break;
 157   2      
 158   2              case 0x2060:
 159   2                  hansen.addr_0x00 = (val_H << 8) |  val_L;
 160   2                  
 161   2                  break;
 162   2      
 163   2              case 0x2062:
 164   2                  hansen.addr_0x02 = (val_H << 8) |  val_L;
 165   2                  
 166   2                  break;
 167   2      
 168   2              case 0x2033:
 169   2      
 170   2                  Write_Dgusii_Vp_byChar(0x20c0,utf_tab,4);
 171   2      
 172   2                  break;
 173   2      
 174   2              case 0x2090:
 175   2                  addr_20a0 = 0;
 176   2                  break;
 177   2      
C51 COMPILER V9.60.7.0   GUI_CTRL                                                          10/15/2025 21:46:46 PAGE 4   

 178   2              case 0x2098:
 179   2                  if( mima_val == 222222 )
 180   2                  {
 181   3                      jump_page(10);
 182   3                      mima_val = 0;
 183   3                      Write_Dgus(0x2090,0x01);
 184   3                      Write_Dgus(0x2091,0xe240);
 185   3                  } 
 186   2                 
 187   2                  break;
 188   2      
 189   2              case 0x20a0:
 190   2                  if( val_L == 1 ) 
 191   2                  {
 192   3                      hansen.addr_0x20 = 0x0200;
 193   3                      hansen.paoji_flag = 1;
 194   3                  }else
 195   2                  {
 196   3                      hansen.addr_0x20 = 0x2000;
 197   3                      Write_Dgus(0x20a4,0);
 198   3                      Write_Dgus(0x20a3,0);
 199   3                      Write_Dgus(0x20a2,0);
 200   3                      jump_page(0);
 201   3                      hansen.paoji_flag = 0;
 202   3                  }  
 203   2                  addr_20a0 = val_L;
 204   2      
 205   2                  break;
 206   2      
 207   2              case 0x20d6:
 208   2                  if( val_L == 4 )
 209   2                  {
 210   3                      hansen.addr_0x2d = 3;    
 211   3                  }
 212   2                  if( val_L == 3 )
 213   2                  {
 214   3                      hansen.addr_0x2d = 4;    
 215   3                  }
 216   2                  break;
 217   2      
 218   2              case 0x20d7:
 219   2                  hansen.addr_0x2d = val_L;
 220   2                  break;  
 221   2      
 222   2              case 0x20d8:
 223   2                  hansen.addr_0x2d = val_L;
 224   2                  jump_page(0);
 225   2                  break;
 226   2      
 227   2              case 0x20a1:
 228   2                  if( addr_20a0 == 0 )
 229   2                  jump_page(0);
 230   2                  break;
 231   2              /*          40001 设置alarm_tempF(val_L) alarm_tempM(val_H)          */
 232   2              case 0x2010:
 233   2                  sp350.alarm_tempF = val_L;
 234   2                  write_slave_06(UART_5,ALARM_TEMP12_ADDR,(uint8_t)sp350.alarm_tempM,(uint8_t)sp350.alarm_tempF)
             -;  
 235   2      
 236   2                  break;
 237   2              
 238   2              case 0x2011:
C51 COMPILER V9.60.7.0   GUI_CTRL                                                          10/15/2025 21:46:46 PAGE 5   

 239   2                  sp350.alarm_tempM = val_L;
 240   2                  write_slave_06(UART_5,ALARM_TEMP12_ADDR,(uint8_t)sp350.alarm_tempM,(uint8_t)sp350.alarm_tempF)
             -;   
 241   2      
 242   2                  break;
 243   2      
 244   2              case 0x2012:
 245   2                  sp350.alarm_tempR = val_L;
 246   2                  write_slave_06(UART_5,ALARM_TEMP3_ADDR,0,(uint8_t)sp350.alarm_tempR);  
 247   2                  
 248   2                  break;
 249   2      
 250   2               
 251   2              /*          40002 设置 F\M\R  Switch                                 */
 252   2              case 0x2013:
 253   2                  sp350.F_switch = val_L;
 254   2                  write_slave_06(UART_5,FM_SWITCH_ADDR,(uint8_t)sp350.M_switch,(uint8_t)sp350.F_switch);  
 255   2      
 256   2                  break;
 257   2              
 258   2              case 0x2014:
 259   2                  sp350.M_switch = val_L;
 260   2                  write_slave_06(UART_5,FM_SWITCH_ADDR,(uint8_t)sp350.M_switch,(uint8_t)sp350.F_switch); 
 261   2      
 262   2                  break;
 263   2      
 264   2              case 0x2015:
 265   2                  sp350.R_switch = val_L;
 266   2                  write_slave_06(UART_5,R_SWITCH_ADDR,0,(uint8_t)sp350.R_switch); 
 267   2      
 268   2                  break;
 269   2      
 270   2              case 0x2016:
 271   2                  sp350.LED_switch = val_L;
 272   2                  write_slave_06(UART_5,LED_SWITCH_ADDR,0,(uint8_t)sp350.LED_switch); 
 273   2      
 274   2                  break;
 275   2      
 276   2              case 0x2017:
 277   2                  sp350.fan_switch = val_L;
 278   2                  write_slave_06(UART_5,LED_SWITCH_ADDR,(uint8_t)sp350.fan_switch,(uint8_t)sp350.fan_level); 
 279   2      
 280   2                  break; 
 281   2      
 282   2              case 0x3018:
 283   2                  sp350.fan_level = val_L;
 284   2                  write_slave_06(UART_5,FAN_ADDR,(uint8_t)sp350.fan_switch,(uint8_t)sp350.fan_level); 
 285   2      
 286   2                  break; 
 287   2      
 288   2              default:
 289   2                  break;
 290   2          }
 291   1      }
 292          
 293          
 294          void jump_page( uint8_t page_num )
 295          {
 296   1          Write_Dgus(0x0085,page_num);
 297   1      
 298   1          Write_Dgus(0x0084,0x5A01);
 299   1      }
C51 COMPILER V9.60.7.0   GUI_CTRL                                                          10/15/2025 21:46:46 PAGE 6   

 300          
 301          void time_trans( uint16_t time_val ,uint8_t num )
 302          {
 303   1          if( num == 0 )
 304   1          {
 305   2              dayin_t.cnt_h = time_val / 3600;
 306   2              dayin_t.cnt_min = (time_val % 3600) / 60;
 307   2              dayin_t.cnt_s = time_val % 60;
 308   2          }else
 309   1          {
 310   2              dayin_t.remain_h = time_val / 3600;
 311   2              dayin_t.remain_min = (time_val % 3600) / 60;
 312   2              dayin_t.remain_s = time_val % 60;
 313   2          }
 314   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1553    ----
   CONSTANT SIZE    =      6    ----
   XDATA SIZE       =    131      11
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
